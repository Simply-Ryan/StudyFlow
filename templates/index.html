{% extends "base.html" %}

{% block title %}Home - Study Sessions{% endblock %}

{% block content %}
<div class="hero">
    <h1>Welcome to StudyFlow for HackD√©couverte</h1>
    <p>Organize and join study sessions with other students!</p>
    {% if 'user_id' in session %}
        <a href="{{ url_for('create') }}" class="btn-large">Create New Session</a>
    {% else %}
        <a href="{{ url_for('register') }}" class="btn-large">Get Started - Register Now</a>
    {% endif %}
</div>

{% if invitations %}
<section class="invitations-section">
    <h2>üì© Your Invitations</h2>
    <div class="invitations-list">
        {% for invitation in invitations %}
        <div class="invitation-card">
            <div class="invitation-header">
                <h3>{{ invitation.session_title }}</h3>
                <span class="badge badge-pending">Pending</span>
            </div>
            <p>{{ invitation.inviter_name }} invited you to join this study session</p>
            <div class="invitation-actions">
                <form method="POST" action="{{ url_for('respond_invitation', invitation_id=invitation.id) }}" style="display: inline;">
                    <input type="hidden" name="response" value="accept">
                    <button type="submit" class="btn-primary">Accept</button>
                </form>
                <form method="POST" action="{{ url_for('respond_invitation', invitation_id=invitation.id) }}" style="display: inline;">
                    <input type="hidden" name="response" value="decline">
                    <button type="submit" class="btn-secondary">Decline</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

{% if reminders %}
<section class="reminders-section">
    <h2><i class="fas fa-bell"></i> Recent Reminders</h2>
    <div class="reminders-list">
        {% for reminder in reminders %}
        <div class="reminder-card">
            <div class="reminder-header">
                <h3>{{ reminder.session_title }}</h3>
                <span class="reminder-time">{{ reminder.created_at }}</span>
            </div>
            <p class="reminder-text">{{ reminder.reminder_text }}</p>
            <p class="reminder-sender">From: {{ reminder.sender_name }}</p>
            <div class="reminder-actions">
                <a href="{{ url_for('detail', session_id=reminder.session_id) }}" class="btn-secondary btn-small">View Session</a>
                <form method="POST" action="{{ url_for('dismiss_reminder', reminder_id=reminder.id) }}" style="display: inline;">
                    <button type="submit" class="btn-dismiss btn-small">‚úï Dismiss</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

<section class="sessions-list">
    <h2>Public Study Sessions</h2>
    
    <div class="filter-search-container">
        <div class="filter-form">
            <div class="filter-group">
                <input type="text" placeholder="Search by title..." class="search-input">
                <select class="subject-filter">
                    <option value="">All Subjects</option>
                    <option value="Mathematics">Mathematics</option>
                    <option value="Physics">Physics</option>
                    <option value="Chemistry">Chemistry</option>
                    <option value="Biology">Biology</option>
                    <option value="Computer Science">Computer Science</option>
                    <option value="Engineering">Engineering</option>
                    <option value="Business">Business</option>
                    <option value="Languages">Languages</option>
                    <option value="History">History</option>
                    <option value="Literature">Literature</option>
                    <option value="General">General</option>
                </select>
            </div>
        </div>
    </div>
    
    {% if sessions %}
        <div class="session-grid">
            {% for session in sessions %}
            <div class="session-card subject-{{ session.subject|replace(' ', '-')|lower }}">
                <div class="subject-badge">{{ session.subject }}</div>
                <h3>{{ session.title }}</h3>
                <p class="session-creator">Created by {{ session.creator_name }}</p>
                
                {% if session.session_date %}
                    <div class="session-time">
                        <span class="time-badge"><i class="fas fa-clock"></i> {{ format_time_remaining(session.session_date) }}</span>
                    </div>
                {% endif %}
                
                <div class="session-info">
                    <span class="badge badge-{{ session.session_type }}">
                        {{ 'üåê Remote' if session.session_type == 'remote' else 'üìç In-Person' }}
                    </span>
                    {% if session.session_type == 'remote' and session.meeting_link %}
                        <p>üîó Meeting available</p>
                    {% elif session.session_type == 'in-person' and session.location %}
                        <p>üìç {{ session.location }}</p>
                    {% endif %}
                </div>
                
                <div class="session-card-footer">
                    <a href="{{ url_for('detail', session_id=session.id) }}" class="btn-secondary">View Details</a>
                    {% if session.user_is_participant %}
                        <a href="{{ url_for('export_to_calendar', session_id=session.id) }}" class="btn-calendar-small" title="Add to Calendar">
                            <i class="fas fa-calendar-plus"></i> Calendar
                        </a>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="empty-state">No study sessions yet. Be the first to create one!</p>
    {% endif %}
</section>
{% endblock %}